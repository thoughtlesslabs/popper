pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
--popper
--thoughtless labs
--a silly game about popcorn

function _init()
	cls()
	mode="start"
	levelnum=1
	levels={}
	levels[1]="ff"
	levels[2]="fff"
	levels[3]="ffffff"
	levels[4]="ffffffffff"
	levels[5]="fffffffffffffffff"
	levels[6]="fffffffffffffffffffffff"
end

--set game mode
function _update()
	if mode=="start" then
		updatestart()
	elseif mode=="game" then
		drawkern()
	end
end

--update and reset game
function updatestart()
	--cls()
	level=levels[levelnum]
	kern(level)
	pop=false
	popcount=0
	mode="game"
end

--user select kernel count
function kcount()
	if mode!="playing" then
	if btnp(0) then
		if levelnum >1 then
			levelnum-=1
			mode="start"
			return
		end
	elseif btnp(1) then
		if levelnum < #levels then
			levelnum+=1
	 	mode="start"
	 	return
		end
	end
end
end
--generate popcorn kernels
function kern(lvl)
	local i,chr
	x={}
	y={}
	v={}
 n={}
	for i=1,#lvl do 
		chr=sub(lvl,i,i)
		if chr=="f" then
			add(x,flr(mid(1,rnd(110),110)))
			add(y,flr(mid(35,rnd(110),110)))
			add(v,true)
			add(n,i)
		end
	end
end

--kernel jitter
function jitter()
	jit={}
	for i=1,50 do
		add(jit,rnd(2))
	end
end

--pop kernels base on user input
function updatekern() 
 mode="playing"
 --pick random kernel to pop
	randnum=flr(rnd(n))
	--check if kernel is already popped
 if v[randnum]==false then
  del(n,randnum)
  updatekern()
	elseif v[randnum] then
		v[randnum]=false
		pop=true
		sfx(0)
		popcount+=1
 end
end

function kernpop()
	if btnp(4) then
		updatekern()
	end
end

function drawkern()
	local i
	cls(5)
	kernpop()
	kcount()
	jitter()
	for i=1,#x do
		if v[i] then
			spr(2,x[i]+rnd(jit),y[i]+rnd(jit))
		elseif pop then
			spr(1,x[i]+5,y[i]+5)
		end
	end
	
	if not(pop) then
		print("how many kernels today?",20,10,7)
		print("⬅️ "..#level.." ➡️",50,20,7)
		print("press 🅾️ to pop",35,30,7)

	elseif popcount==#x then
		retry()
	end
end	

function retry()
	rectfill(35,35,95,60,4)
	print("play again?",45,40,7)
	print("press ❎",50,50,7)
	update_retry()
end

function update_retry()
	if btn(5) then
		mode="start"
	end
end

function _draw()
	if mode=="game" or mode=="playing" then
		drawkern()
	elseif mode=="start" then
		updatestart()
	end
end
__gfx__
00000000000776000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009977600004499000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700779967760044449000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000779667760044444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000776677660444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700677777760444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000067777660044000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555757557757575555577757775775575755555757577757775775577757555577555557775577577557775757577755555555555555555
55555555555555555555757575757575555577757575757575755555757575557575757575557555755555555755757575757575757555755555555555555555
55555555555555555555777575757575555575757775757577755555775577557755757577557555777555555755757575757775777557755555555555555555
55555555555555555555757575757775555575757575757555755555757575557575757575557555557555555755757575757575557555555555555555555555
55555555555555555555757577557775555575757575757577755555757577757575757577757775775555555755775577757575777557555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555577777555555775577755555577777555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555777557755555575555755555775577755555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555775557755555575555755555775557755555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555777557755555575555755555775577755555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555577777555555777555755555577777555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555777577757775577557755555577777555555777557755555777557757775555555555555555555555555555555555
55555555555555555555555555555555555757575757555755575555555775557755555575575755555757575757575555555555555555555555555555555555
55555555555555555555555555555555555777577557755777577755555775757755555575575755555777575757775555555555555555555555555555555555
55555555555555555555555555555555555755575757555557555755555775557755555575575755555755575757555555555555555555555555555555555555
55555555555555555555555555555555555755575757775775577555555577777555555575577555555755577557555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555554995555555555555555555555555555555555555549955555555555555555555554995555555555549955555555555555555555555555555
55555555555555544495555555555555555555555555555555555555444955555555555555555555544495555555555444955555555555555555555555555555
55555555555555444445555555555555555555555555555555555554444455555555555555555555444445555555554444455555555555555555555555555555
55555555555555444455555555555555555555555555555555555554444555555555555555555555444455555555554444555555555555555555555555555555
55555555555555544555555555555555555555555555555555555555445555555555555555555555544555555555555445555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555499555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555554449555499555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555544444554449555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555544445544444555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555554455544445555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555554455555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555499555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555554449555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555544444555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555544445555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555554455555555555555555555555554995555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555544495555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555444445555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555444455555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555544555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555549955555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555444955555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555554444455555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555554444555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555445555555555555555555555555555555555555555555555555555555555555555555555555
55555499555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555499555555555555555555555
55554449555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555554449555555555555555555555
55544444555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544444555555555555555555555
55544445555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544445555555555555555555555
55554455555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555554455555554995555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544495555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555444445555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555444455555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555499555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555554449555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544444555555555499555555555555555555555
55555555555549955555555555555555555555555555555555555555555555555555555555555555555555555544445555555554449555555555555555555555
55555555555444955555555555555555555555555555555555555555555555555555555555555555555555555554455555555544444555555555555555555555
55555555554444455555555555555555555555555555555555555555555555555555555555555555555554995555555555555544445555555555555555555555
55555555554444555555555555555555555555555555555555555555555555555555555555555555555544495555555555555554455555555555555555555555
55555555555445555555555555555555555555555555555555555555555555555555555555555555555444445555555555555555555555555555555555555555
55555555555555555555555555555499555555555555555555555555555555555555555555555555555444455555555555555555555555555555555555555555
55555555555555555555555555554449555555555555555555555555555555555555555555555555555544555555555555555555555555555555555555555555
55555555555555555555555555544444555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555544445555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555554455555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555

__sfx__
000100002a65025650206501a650126500a6500760001600006001b6000b6000f60023600006002860008600096002e6000b6000f600126001960000600006000060000600006000060000600006000060000600
